services:
  nubbybot:
    build: .
    container_name: nubbybot
    restart: unless-stopped
    user: "1028:65537"
    environment:
      - DISCORD_TOKEN
      - DISCORD_APP_ID=1363093908526993509
      - ANTHROPIC_API_KEY
      - DB_PATH=/config/nubbybot.db
      - LOG_LEVEL=debug
      - BACKFILL_BATCH_DELAY_MS=1000
      - PROFILE_UPDATE_INTERVAL_HOURS=24
      - ADMIN_PORT=7774
      - ADMIN_TOKEN
    ports:
      - "7774:7774"
    volumes:
      - /volume2/docker-ssd/nubbybot/config:/config:rw
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
